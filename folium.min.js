var FoliumTable=function(b,p){function C(a){-1===a?(g=-1,q=void 0):e===$(document).attr("activeTable")&&(g=a,void 0!==q&&q.removeClass("selectedRow"),a=(new Number(a+1)).toString(),q=$("#"+e+" tr:eq("+a+")"),q.focus(),q.addClass("selectedRow"))}function w(a){if(!(a>=F)&&e===$(document).attr("activeTable")){$("#"+e+" th:eq("+k+")").removeClass("selectedColumnHeader");k=a;void 0!==r&&r.removeClass("selectedColumn");var b=(new Number(g+1)).toString();r=$("#"+e+" tr:eq("+b+")").find("td:eq("+a+")");r.addClass("selectedColumn");
$("#"+e+" th:eq("+k+")").addClass("selectedColumnHeader");r.focus()}}function K(a,b){return a.localeCompare(b,l)}function G(a,b){return a-b}function H(a,c){c=void 0===c?!0:c;if(-1!==a&&b.sortable){var f=b.columns[a].columnId,d=b.columns[a].dataType,e=I.get(f);c&&(e*=-1,I.set(f,e));var O=t.get(d),x=m?a:f;b.rows.sort(function(a,b){return e*O(a[x],b[x])})}}function J(a){a=void 0===a?b.rows:a;var c=a.length%d.pageSize;d.numOfPages=parseInt(a.length/d.pageSize);d.numOfPages=0!==c?d.numOfPages+1:d.numOfPages;
c=(d.currentPage-1)*d.pageSize+1;a=c+a.slice((d.currentPage-1)*d.pageSize,d.currentPage*d.pageSize).length-1;$("#"+e+"pageInfo").val(c+"-"+a+" | Page: "+d.currentPage+"/"+d.numOfPages)}function n(a){a=void 0===a?b.rows:a;$("#"+b.tableId+" tbody").remove();D(a);J(a)}function D(a){a=void 0===a?b.rows:a;p.append("<tbody>");var c="";(b.pagination.active?a.slice((d.currentPage-1)*d.pageSize,d.currentPage*d.pageSize):a).forEach(function(a,d){var f='<tr class="'+(0===d%2?"evenRow":"oddRow")+'">';b.columns.forEach(function(b,
c){var e=m?a[c]:a[b.columnId];var A=y(d,c,e,a);f+=void 0===e?"<td></td>":"<td>"+A+"</td>"});f+="</tr>";c+=f});p.append(c);p.append("</tbody>");$("#"+e).on("click","td",function(){var a=$(this).parent(),b=$(this);a=a.index();b=b.index();C(a);w(b);B.get("rowClicked")(a)});$("#"+b.tableId+" td").dblclick(function(){var a=$(this).parent().index();L($(this));B.get("rowDoubleClicked")(a)})}function L(a){var c=a.css("width"),f=a.parent().index(),d=a.index(),e=b.columns[d].columnId,h=m?b.rows[f][d]:b.rows[f][e];
if(b.editable){a.html('<input type="text" id="cellEditor" style="width:'+c+'" value="'+h+'" />');var x=$("#cellEditor");x.focus();x[0].setSelectionRange(h.length,h.length);$("#cellEditor").focusout(function(){var c=x.val();c=u.get(b.columns[d].dataType)(c);m?b.rows[f][d]=c:b.rows[f][e]=c;c=y(f,d,c,b.rows[f]);a.html(c)});$("#cellEditor").keypress(function(a){13===a.keyCode&&(w(d+1),p.focus())})}}var P=this;if(void 0===b.columns)console.error('"columns" property is not defined in table settings. Please make sure that it is defined in your table settings.');
else if(void 0===b.rows)console.error('"rows" property is not defined in table settings. Please make sure that it is defined in your table settings.');else{var h=b.rows.length,F=b.columns.length,g=-1,q=void 0,k=-1,r=void 0,e=b.tableId,y=void 0,M=void 0,l="en-US",v="",E=-1,z=-1,m=void 0,d={pageSize:-1,numOfPages:0,currentPage:1},I=new Map,t=new Map,B=new Map,u=new Map;B.set("rowClicked",function(a){});B.set("rowDoubleClicked",function(a){});b.pagination=void 0===b.pagination?{active:!1,size:-1}:b.pagination;
b.sortable=void 0===b.sortable?!1:b.sortable;b.editable=void 0===b.editable?!1:b.editable;b.searching=void 0===b.searching?!1:b.searching;t.set("number",G);t.set("float",G);t.set("integer",G);t.set("datetime",function(a,b){return a>b?1:a<b?-1:0});t.set("string",K);t.set(void 0,K);u.set("integer",function(a){return parseInt(a)});u.set("float",function(a){return parseFloat(a)});u.set("number",function(a){return parseFloat(a)});u.set("datetime",function(a){return new Date(a)});u.set("integer",function(a){return a.toString()});
u.set(void 0,function(a){return a.toString()});p.addClass("folium");p.attr("tabindex","0");m=void 0!==b.rowsAsArrays&&null!==b.rowsAsArrays&&"boolean"===typeof b.rowsAsArrays?b.rowsAsArrays:!1;y=void 0!==b.cellRenderer?b.cellRenderer:function(a,b,d,e){return d};M=void 0!==b.headerRenderer?b.headerRenderer:function(a,b,d){return b};void 0!==b.width&&$(".folium").css("width",""+b.width);void 0!==b.height&&$(".folium").css("height",""+b.height);var N=b.columns;N.forEach(function(a){return I.set(a.columnId,
-1)});(function(a){var b='<thead><tr id="columns">';a.forEach(function(a,c){return b+='<th class="columnHeader sortHeader" id="'+a.columnId+'">'+M(c,a.displayText,a)+"</th>"});b+="</tr>";p.append(b+"</thead>")})(N);b.pagination.active&&"number"===typeof b.pagination.size&&($("#"+e).before('<div class="foliumPageBar"><button id="'+e+'foliumPageFirst" class="pageBarButton">First</button><button class="pageBarButton" id="'+e+'foliumPagePrevious"><</button><input type="text" id="'+e+'pageInfo" class="infoBox" readonly /><button class="pageBarButton" id="'+
e+'foliumPageNext">></button><button class="pageBarButton" id="'+e+'foliumPageLast">Last</button></div>'),$(".foliumPageBar").css("width",$("#"+e).css("width")),d.pageSize=b.pagination.size,J(),$("#"+e+"foliumPageNext").click(function(){d.currentPage+1>d.numOfPages||(d.currentPage++,n())}),$("#"+e+"foliumPagePrevious").click(function(){1>d.currentPage-1||(d.currentPage--,n())}),$("#"+e+"foliumPageFirst").click(function(){1!==d.currentPage&&(d.currentPage=1,n())}),$("#"+e+"foliumPageLast").click(function(){d.currentPage!==
d.numOfPages&&(d.currentPage=d.numOfPages,n())}));void 0===b.pagination.size&&console.error("Pagination size is not defined! Pagination skipped.");D();$("td,th").on("focus",function(){$(P).closest("table").focus()});$("#"+b.tableId).focus(function(){$(document).attr("activeTable",b.tableId)});$("#"+b.tableId).focusout(function(){$(document).attr("activeTable",null)});$("#"+e+" th").click(function(){var a=$(this).index();z=a;b.sortable&&(H(a),$("#"+b.tableId+" tbody").remove(),D())});$(document).keydown(function(a){var c=
$(document).attr("activeTable");a=a.keyCode;null!==c&&void 0!==c&&c===e&&(37===a?0>=k||w(k-1):38===a?0>=g||(C(g-1),w(k)):39===a?k!==F-1&&w(k+1):40===a?(c=$("#"+e+" tbody tr").length,g!==(b.pagination.active?c-1:h-1)&&(C(g+1),w(k))):b.editable&&L(r))});this.addRow=function(a){b.rows.push(a);h+=1;if(""!==v)this.search(v,E);else if(-1!==z&&H(z,!1),b.pagination.active)n();else{var c='<tr class="'+(0===(h-1)%2?"evenRow":"oddRow")+'">';b.columns.forEach(function(b,d){var e=m?a[d]:a[b.columnId],f=y(h-1,
d,e,a);c+=void 0===e?"<td></td>":"<td>"+f+"</td>"});c+="</tr>";-1===$("#"+e+" tbody tr:last").index()?$("#"+e+" tbody").html(c):$("#"+e+" tbody tr:last").after(c)}};this.addRows=function(a){b.rows=b.rows.concat(a);if(""!==v)this.search(v,E);else if(-1!==z&&H(z,!1),b.pagination.active)n();else{var c="";a.forEach(function(a){var d='<tr class="'+(0===(h-1)%2?"evenRow":"oddRow")+'">';b.columns.forEach(function(b,c){var e=m?a[c]:a[b.columnId],f=y(h-1,c,e,a);d+=void 0===e?"<td></td>":"<td>"+f+"</td>"});
d+="</tr>";c+=d;h++});-1===$("#"+e+" tbody tr:last").index()?$("#"+e+" tbody").html(c):$("#"+e+" tbody tr:last").after(c)}};this.updateRow=function(a,c){var f=b.rows[a];m?Object.keys(c).forEach(function(a){var d=b.columns.map(function(a){return a.columnId}).indexOf(a);f[d]=c[a]}):Object.keys(c).forEach(function(a){return f[a]=c[a]});var A="";b.columns.forEach(function(a,b){var c=m?f[b]:f[a.columnId],d=y(h-1,b,c,f);A+=void 0===c?"<td></td>":"<td>"+d+"</td>"});var g=a+1;if(b.pagination.active){g=(d.currentPage-
1)*d.pageSize;var k=d.currentPage*d.pageSize-1;a>=g&&a<=k&&$("#"+e+" tr:eq("+(a-g+1)+")").html(A)}else $("#"+e+" tr:eq("+g+")").html(A)};this.updateRows=function(a,b){for(var c=0;c<a.length;c++)this.updateRow(a[c],b[c])};this.deleteRow=function(a){b.rows.splice(a,1);--h;if(""!==v)this.search(v,E);else if(b.pagination.active)n();else for(C(a-1),$("#"+e+" tr:eq("+(a+1)+")").remove();a<h;a++){var c=0===a%2?"evenRow":"oddRow";$("#"+e+" tr:eq("+(a+1)+")").removeClass().addClass(c)}};this.deleteRows=function(a){var b=
this;a.forEach(function(a){return b.deleteRow(a)})};this.selectedRow=function(){return g};this.selectedRowInModel=function(){return b.pagination.active?(d.currentPage-1)*d.pageSize+g:g};this.selectedColumn=function(){return k};this.columnCount=function(){return F};this.rowCount=function(){return h};this.getRow=function(a){return b.rows[a]};this.getRows=function(){return b.rows};this.on=function(a,b){B.set(a,b)};this.currentPage=function(){return currentPage};this.pageCount=function(){return pageCount};
this.getId=function(){return e};this.setLocale=function(a){l=a};this.search=function(a,c){c=void 0===c?-1:c;if(b.searching){v=a;var e=null;e=m?-1!==c?b.rows.filter(function(b){return b[c].toLowerCase(l).includes(a.toLowerCase(l))}):b.rows.filter(function(b){return Object.values(b).join(";").toLowerCase(l).includes(a.toLowerCase(l))}):-1!==c?b.rows.filter(function(d){return d[b.columns[c].columnId].toLowerCase(l).includes(a.toLowerCase(l))}):b.rows.filter(function(b){return Object.values(b).join(";").toLowerCase(l).includes(a.toLowerCase(l))});
$("#"+b.tableId+" tbody").remove();b.pagination.active?(d.currentPage=1,n(e)):D(e);return e.length}console.error("Searching is not enabled for this table! You can enable searching by defining searching property as true for the table settings.")};this.clear=function(){$("#"+e+" tbody").empty();b.rows=[];h=0;k=g=-1;r=q=void 0;z=E=-1;d.currentPage=1;d.numOfPages=0;b.pagination.active&&J(b.rows)}}};
$.fn.FoliumTable=function(b){if(void 0===b)return this[0].foliumObject;b.tableId=this[0].id;b=new FoliumTable(b,$(this));this[0].foliumObject=b;return this[0].foliumObject};