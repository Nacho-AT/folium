var FoliumTable=function(b,F){function I(a){-1===a?(p=-1,t=void 0):e===$(document).attr("activeTable")&&(p=a,P=b.rows[J(a)]._ROW_ID,void 0!==t&&t.removeClass("selectedRow"),a=(new Number(a)).toString(),t=$("#"+e+" tbody tr:eq("+a+")"),t.focus(),t.addClass("selectedRow"))}function w(a){if(!(a>=K)&&e===$(document).attr("activeTable")){$("#"+e+" thead th:eq("+l+")").removeClass("selectedColumnHeader");l=a;void 0!==u&&u.removeClass("selectedColumn");var b=(new Number(p)).toString();u=$("#"+e+" tbody tr:eq("+
b+")").find("td:eq("+a+")");u.addClass("selectedColumn");$("#"+e+" thead th:eq("+l+")").addClass("selectedColumnHeader");u.focus()}}function Q(a,b){return a.localeCompare(b,q)}function L(a,b){return a-b}function M(a,d){d=void 0===d?!0:d;if(-1!==a&&b.sortable){var f=b.columns[a].columnId,m=b.columns[a].dataType,c=N.get(f);d&&(c*=-1,N.set(f,c));var e=x.get(m),v=r?a:f;g?k.sort(function(a,b){return c*e(a[v],b[v])}):b.rows.sort(function(a,b){return c*e(a[v],b[v])})}}function O(a){a=void 0===a?b.rows:a;
var d=a.length%c.pageSize;c.numOfPages=parseInt(a.length/c.pageSize);c.numOfPages=0!==d?c.numOfPages+1:c.numOfPages;d=(c.currentPage-1)*c.pageSize+1;a=d+a.slice((c.currentPage-1)*c.pageSize,c.currentPage*c.pageSize).length-1;if($("#foliumPageJumpTo option").length!==c.numOfPages){$("#foliumPageJumpTo").empty();for(var f="",m=2;m<=c.numOfPages;m++)f+='<option value="'+m+'">'+m+"</option>";$("#foliumPageSwitcher").html('<select id="foliumPageJumpTo" class="pageJumpComboBox"><option value="1">1</option>'+
f+"</select> / "+c.numOfPages);$("#foliumPageJumpTo").change(function(){c.currentPage=parseInt($(this).val());n(g?k:b.rows)})}$("#foliumPageJumpTo option:selected").prop("selected",!1);$("#foliumPageJumpTo option[value="+c.currentPage+"]").prop("selected",!0);$("#currentPageInfo").html(d+"-"+a+" | Page: ")}function n(a){a=void 0===a?b.rows:a;$("#"+b.tableId+" tbody").remove();y(a);O(a)}function y(a){a=void 0===a?b.rows:a;a=b.pagination.active?a.slice((c.currentPage-1)*c.pageSize,c.currentPage*c.pageSize):
a;var d="";z=[];a.forEach(function(a,f){var c='<tr class="'+(0===f%2?"evenRow":"oddRow")+'">';b.columns.forEach(function(b,d){var m=r?a[d]:a[b.columnId],e=D(f,d,m,a);c+=void 0===m?"<td></td>":"<td>"+e+"</td>"});c+="</tr>";d+=c;z.push(a._ROW_ID)});F.append("<tbody>"+d+"</tbody>");a=a.map(function(a){return a._ROW_ID}).indexOf(P);if(-1!==a){a=$("#"+e+" tbody tr:eq("+a+")");a.removeClass();a.addClass("selectedRow");var f=a.find("td:eq("+l+")");f.addClass("selectedColumn");t=a;u=f}$("#"+e+" tbody").on("click",
"td",function(){var a=$(this).parent(),b=$(this);a=a.index();b=b.index();I(a);w(b);G.get("rowClicked")(a)});$("#"+b.tableId+" tbody td").dblclick(function(){var a=$(this).parent().index();R($(this));G.get("rowDoubleClicked")(a)})}function J(a){return-1===a?-1:g?(a=k[b.pagination.active?(c.currentPage-1)*c.pageSize+a:a]._ROW_ID,b.rows.map(function(a){return a._ROW_ID}).indexOf(a)):b.pagination.active?(c.currentPage-1)*c.pageSize+a:a}function R(a){var d=a.css("width"),f=a.parent().index(),c=a.index(),
e=b.pagination.active?J(f):f,g=b.columns[c].columnId,v=r?b.rows[e][c]:b.rows[e][g];if(b.editable){a.html('<input type="text" id="cellEditor" style="width:'+d+'" value="'+v+'" />');var h=$("#cellEditor");h.focus();h[0].setSelectionRange(v.length,v.length);$("#cellEditor").focusout(function(){var d=h.val();d=A.get(b.columns[c].dataType)(d);r?b.rows[e][c]=d:b.rows[e][g]=d;d=D(f,c,d,b.rows[e]);a.html(d)});$("#cellEditor").keypress(function(a){13===a.keyCode&&(w(c+1),F.focus())})}}var U=this;if(void 0===
b.columns)console.error('"columns" property is not defined in table settings. Please make sure that it is defined in your table settings.');else{b.rows=void 0===b.rows?[]:b.rows;var h=b.rows.length,K=b.columns.length,E=0,p=-1,P=-1,t=void 0,l=-1,u=void 0,e=b.tableId,D=void 0,S=void 0,q="en-US",B="",g=!1,H=-1,C=-1,k=void 0,r=void 0,z=[],c={pageSize:-1,numOfPages:0,currentPage:1},N=new Map,x=new Map,G=new Map,A=new Map;G.set("rowClicked",function(a){});G.set("rowDoubleClicked",function(a){});b.pagination=
void 0===b.pagination?{active:!1,size:-1}:b.pagination;b.sortable=void 0===b.sortable||"boolean"!==typeof b.sortable?!1:b.sortable;b.editable=void 0===b.editable||"boolean"!==typeof b.editable?!1:b.editable;b.showSearchHint=void 0===b.showSearchHint||"boolean"!==typeof b.showSearchHint?!0:b.showSearchHint;if(0<b.columns.filter(function(a){return"_ROW_ID"===a.columnId}).length)console.error("_ROW_ID is specifically defined column for Folium Table. Please try to name this column with a different name.");
else{b.rows.forEach(function(a){Object.defineProperty(a,"_ROW_ID",{value:E,writable:!1,enumerable:!0,configurable:!1});E++});x.set("number",L);x.set("float",L);x.set("integer",L);x.set("datetime",function(a,b){return a>b?1:a<b?-1:0});x.set("string",Q);x.set(void 0,Q);A.set("integer",function(a){return parseInt(a)});A.set("float",function(a){return parseFloat(a)});A.set("number",function(a){return parseFloat(a)});A.set("datetime",function(a){return new Date(a)});A.set("integer",function(a){return a.toString()});
A.set(void 0,function(a){return a.toString()});F.addClass("folium");F.attr("tabindex","0");r=void 0!==b.rowsAsArrays&&null!==b.rowsAsArrays&&"boolean"===typeof b.rowsAsArrays?b.rowsAsArrays:!1;D=void 0!==b.cellRenderer?b.cellRenderer:function(a,b,c,e){return c};S=void 0!==b.headerRenderer?b.headerRenderer:function(a,b,c){return b};void 0!==b.width&&$(".folium").css("width",""+b.width);void 0!==b.height&&$(".folium").css("height",""+b.height);var T=b.columns;T.forEach(function(a){return N.set(a.columnId,
-1)});(function(a){var b='<thead><tr id="columns">';a.forEach(function(a,d){return b+='<th class="columnHeader sortHeader" id="'+a.columnId+'">'+S(d,a.displayText,a)+"</th>"});b+="</tr>";F.append(b+"</thead>")})(T);b.pagination.active&&"number"===typeof b.pagination.size&&($("#"+e).before('<div class="foliumPageBar"><button id="'+e+'foliumPageFirst" class="pageBarButton">First</button><button class="pageBarButton" id="'+e+'foliumPagePrevious"><</button><div id="'+e+'pageInfo" class="infoBox"><span id="currentPageInfo"></span><div id="foliumPageSwitcher"><select id="foliumPageJumpTo" class="pageJumpComboBox"><option value="1">1</option></select> / 0</div></div><button class="pageBarButton" id="'+
e+'foliumPageNext">></button><button class="pageBarButton" id="'+e+'foliumPageLast">Last</button><span id="searchInfo" class="pageBarText"></span></div>'),$(".foliumPageBar").css("width",$("#"+e).css("width")),c.pageSize=b.pagination.size,O(),$("#"+e+"foliumPageNext").click(function(){c.currentPage+1>c.numOfPages||(c.currentPage++,n(g?k:b.rows))}),$("#"+e+"foliumPagePrevious").click(function(){1>c.currentPage-1||(c.currentPage--,n(g?k:b.rows))}),$("#"+e+"foliumPageFirst").click(function(){1!==c.currentPage&&
(c.currentPage=1,n(g?k:b.rows))}),$("#"+e+"foliumPageLast").click(function(){c.currentPage!==c.numOfPages&&(c.currentPage=c.numOfPages,n(g?k:b.rows))}));void 0===b.pagination.size&&console.error("Pagination size is not defined! Pagination skipped.");y();$("td,th").on("focus",function(){$(U).closest("table").focus()});$("#"+b.tableId).focus(function(){$(document).attr("activeTable",b.tableId)});$("#"+b.tableId).focusout(function(){$(document).attr("activeTable",null)});$("#"+e+" thead th").click(function(){var a=
$(this).index();C=a;w(a);b.sortable&&(M(a),$("#"+b.tableId+" tbody").remove(),y(g?k:b.rows))});$(document).keydown(function(a){var d=$(document).attr("activeTable");a=a.keyCode;null!==d&&void 0!==d&&d===e&&(37===a?0>=l||w(l-1):38===a?0>=p||(I(p-1),w(l)):39===a?l!==K-1&&w(l+1):40===a?(d=$("#"+e+" tbody tr").length,p!==(b.pagination.active?d-1:h-1)&&(I(p+1),w(l))):b.editable&&R(u))});this.addRow=function(a){Object.defineProperty(a,"_ROW_ID",{value:E,writable:!1,enumerable:!0,configurable:!1});E++;b.rows.push(a);
var d=0===h?0:h;h+=1;if(g)this.search(B,H);else if(-1!==C&&(M(C,!1),d=b.rows.map(function(a){return a._ROW_ID}).indexOf(a._ROW_ID)),b.pagination.active)n();else{var c='<tr class="'+(0===d%2?"evenRow":"oddRow")+'">';b.columns.forEach(function(b,e){var f=r?a[e]:a[b.columnId],m=D(d,e,f,a);c+=void 0===f?"<td></td>":"<td>"+m+"</td>"});c+="</tr>";z.push(a._ROW_ID);1===h?$("#"+e+" tbody").append(c):0===d?$("#"+e+" tbody tr:eq(0)").before(c):$("#"+e+" tbody tr:eq("+(d-1)+")").after(c)}};this.addRows=function(a){a.forEach(function(a){Object.defineProperty(a,
"_ROW_ID",{value:E,writable:!1,enumerable:!0,configurable:!1});E++});b.rows=b.rows.concat(a);if(g)this.search(B,H);else if(-1!==C&&M(C,!1),b.pagination.active)n();else if(-1!==C)$("#"+e+" tbody").empty(),y(g?k:b.rows);else{var d="";a.forEach(function(a){var c='<tr class="'+(0===h%2?"evenRow":"oddRow")+'">';b.columns.forEach(function(b,d){var e=r?a[d]:a[b.columnId],f=D(h-1,d,e,a);c+=void 0===e?"<td></td>":"<td>"+f+"</td>"});c+="</tr>";d+=c;h++;z.push(a._ROW_ID)});$("#"+e+" tbody").append(d)}};this.updateRow=
function(a,d){r?(Object.defineProperty(d,"_ROW_ID",{value:b.rows[a]._ROW_ID,writable:!1,enumerable:!0,configurable:!1}),b.rows[a]=d):Object.keys(d).forEach(function(c){return b.rows[a][c]=d[c]});var c=b.rows[a],g="";b.columns.forEach(function(a,b){var d=r?c[b]:c[a.columnId],e=D(h-1,b,d,c);g+=void 0===d?"<td></td>":"<td>"+e+"</td>"});var k=z.indexOf(c._ROW_ID);-1!==k&&$("#"+e+" tbody tr:eq("+k+")").html(g)};this.updateRows=function(a,b){var d=this;a.forEach(function(a,c){return d.updateRow(a,b[c])})};
this.deleteRow=function(a){var d=b.rows.splice(a,1)[0];if(void 0!==d)if(--h,g)this.search(B,H);else if(b.pagination.active)n();else if(d=z.indexOf(d._ROW_ID),z.splice(d,1),-1!==d&&(console.log(d),-1!==d))for(I(0!==d?d-1:0),$("#"+e+" tbody tr:eq("+d+")").remove();a<h;a++)d=0===a%2?"evenRow":"oddRow",$("#"+e+" tbody tr:eq("+a+")").removeClass().addClass(d)};this.deleteRows=function(a){var d=a.filter(function(a){return a<h});b.rows=b.rows.filter(function(a,b){return-1===d.indexOf(b)});h-=d.length;g?
this.search(B,H):b.pagination.active?n():($("#"+b.tableId+" tbody").remove(),y())};this.selectedRow=function(){return p};this.selectedRowInModel=function(){return J(p)};this.selectedColumn=function(){return l};this.columnCount=function(){return K};this.rowCount=function(){return h};this.getRow=function(a){return b.rows[a]};this.getRows=function(){return b.rows};this.on=function(a,b){G.set(a,b)};this.currentPage=function(){return currentPage};this.pageCount=function(){return pageCount};this.getId=
function(){return e};this.setLocale=function(a){q=a};this.search=function(a,d){d=void 0===d?-1:d;if(void 0===a||null===a||""===a)return k=void 0,B="",g=!1,$("#searchInfo").html(""),b.pagination.active?(c.currentPage=1,n()):y(),b.rows.length;B=a;k=r?-1!==d?b.rows.filter(function(b){return b[d].toLowerCase(q).includes(a.toLowerCase(q))}):b.rows.filter(function(b){return Object.values(b).join("`").toLowerCase(q).includes(a.toLowerCase(q))}):-1!==d?b.rows.filter(function(c){return c[b.columns[d].columnId].toLowerCase(q).includes(a.toLowerCase(q))}):
b.rows.filter(function(b){return Object.values(b).join("`").toLowerCase(q).includes(a.toLowerCase(q))});$("#"+b.tableId+" tbody").remove();b.pagination.active?(c.currentPage=1,n(k)):y(k);g=!0;b.pagination.active&&b.showSearchHint&&$("#searchInfo").html('Search Results for "'+B+'" presented'+(-1!==d?" according to <b>"+b.columns[d].displayText+"</b> column.":"."));return k.length};this.clear=function(){$("#"+e+" tbody").empty();b.rows=[];h=0;l=p=-1;u=t=void 0;C=H=-1;c.currentPage=1;c.numOfPages=0;
b.pagination.active&&O(b.rows)}}}};$.fn.FoliumTable=function(b){if(void 0===b)return this[0].foliumObject;b.tableId=this[0].id;b=new FoliumTable(b,$(this));this[0].foliumObject=b;return this[0].foliumObject};