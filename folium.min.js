var FoliumTable=function(b,E){function H(a){-1===a?(p=-1,u=void 0):e===$(document).attr("activeTable")&&(p=a,P=b.rows[J(a)]._ROW_ID,void 0!==u&&u.removeClass("selectedRow"),a=(new Number(a)).toString(),u=$("#"+e+" tbody tr:eq("+a+")"),u.focus(),u.addClass("selectedRow"))}function x(a){if(!(a>=K)&&e===$(document).attr("activeTable")){$("#"+e+" thead th:eq("+l+")").removeClass("selectedColumnHeader");l=a;void 0!==v&&v.removeClass("selectedColumn");var b=(new Number(p)).toString();v=$("#"+e+" tbody tr:eq("+
b+")").find("td:eq("+a+")");v.addClass("selectedColumn");$("#"+e+" thead th:eq("+l+")").addClass("selectedColumnHeader");v.focus()}}function Q(a,b){return a.localeCompare(b,q)}function L(a,b){return a-b}function M(a,c){c=void 0===c?!0:c;if(-1!==a&&b.sortable){var k=b.columns[a].columnId,g=b.columns[a].dataType,d=N.get(k);c&&(d*=-1,N.set(k,d));var e=y.get(g),w=r?a:k;m?f.sort(function(a,b){return d*e(a[w],b[w])}):b.rows.sort(function(a,b){return d*e(a[w],b[w])})}}function O(a){a=void 0===a?b.rows:a;
var c=a.length%d.pageSize;d.numOfPages=parseInt(a.length/d.pageSize);d.numOfPages=0!==c?d.numOfPages+1:d.numOfPages;c=(d.currentPage-1)*d.pageSize+1;a=c+a.slice((d.currentPage-1)*d.pageSize,d.currentPage*d.pageSize).length-1;if($("#foliumPageJumpTo option").length!==d.numOfPages){$("#foliumPageJumpTo").empty();for(var k="",g=2;g<=d.numOfPages;g++)k+='<option value="'+g+'">'+g+"</option>";$("#foliumPageSwitcher").html('<select id="foliumPageJumpTo" class="pageJumpComboBox"><option value="1">1</option>'+
k+"</select> / "+d.numOfPages);$("#foliumPageJumpTo").change(function(){d.currentPage=parseInt($(this).val());n(m?f:b.rows)})}$("#foliumPageJumpTo option:selected").prop("selected",!1);$("#foliumPageJumpTo option[value="+d.currentPage+"]").prop("selected",!0);$("#currentPageInfo").html(c+"-"+a+" | Page: ")}function n(a){a=void 0===a?b.rows:a;$("#"+b.tableId+" tbody").remove();A(a);O(a)}function A(a){a=void 0===a?b.rows:a;a=b.pagination.active?a.slice((d.currentPage-1)*d.pageSize,d.currentPage*d.pageSize):
a;var c="";I=[];a.forEach(function(a,k){var d='<tr class="'+(0===k%2?"evenRow":"oddRow")+'">';b.columns.forEach(function(b,c){var g=r?a[c]:a[b.columnId],e=B(k,c,g,a);d+=void 0===g?"<td></td>":"<td>"+e+"</td>"});d+="</tr>";c+=d;I.push(a._ROW_ID)});E.append("<tbody>"+c+"</tbody>");a=a.map(function(a){return a._ROW_ID}).indexOf(P);if(-1!==a){a=$("#"+e+" tbody tr:eq("+a+")");a.removeClass();a.addClass("selectedRow");var k=a.find("td:eq("+l+")");k.addClass("selectedColumn");u=a;v=k}$("#"+e+" tbody").on("click",
"td",function(){var a=$(this).parent(),b=$(this);a=a.index();b=b.index();H(a);x(b);F.get("rowClicked")(a)});$("#"+b.tableId+" tbody td").dblclick(function(){var a=$(this).parent().index();R($(this));F.get("rowDoubleClicked")(a)})}function J(a){return-1===a?-1:m?(a=f[b.pagination.active?(d.currentPage-1)*d.pageSize+a:a]._ROW_ID,b.rows.map(function(a){return a._ROW_ID}).indexOf(a)):b.pagination.active?(d.currentPage-1)*d.pageSize+a:a}function R(a){var c=a.css("width"),d=a.parent().index(),g=a.index(),
e=b.pagination.active?J(d):d,h=b.columns[g].columnId,w=r?b.rows[e][g]:b.rows[e][h];if(b.editable){a.html('<input type="text" id="cellEditor" style="width:'+c+'" value="'+w+'" />');var f=$("#cellEditor");f.focus();f[0].setSelectionRange(w.length,w.length);$("#cellEditor").focusout(function(){var c=f.val();c=z.get(b.columns[g].dataType)(c);r?b.rows[e][g]=c:b.rows[e][h]=c;c=B(d,g,c,b.rows[e]);a.html(c)});$("#cellEditor").keypress(function(a){13===a.keyCode&&(x(g+1),E.focus())})}}var U=this;if(void 0===
b.columns)console.error('"columns" property is not defined in table settings. Please make sure that it is defined in your table settings.');else{b.rows=void 0===b.rows?[]:b.rows;var h=b.rows.length,K=b.columns.length,C=0,p=-1,P=-1,u=void 0,l=-1,v=void 0,e=b.tableId,B=void 0,S=void 0,q="en-US",t="",m=!1,G=-1,D=-1,f=void 0,r=void 0,I=[],d={pageSize:-1,numOfPages:0,currentPage:1},N=new Map,y=new Map,F=new Map,z=new Map;F.set("rowClicked",function(a){});F.set("rowDoubleClicked",function(a){});b.pagination=
void 0===b.pagination?{active:!1,size:-1}:b.pagination;b.sortable=void 0===b.sortable||"boolean"!==typeof b.sortable?!1:b.sortable;b.editable=void 0===b.editable||"boolean"!==typeof b.editable?!1:b.editable;b.showSearchHint=void 0===b.showSearchHint||"boolean"!==typeof b.showSearchHint?!0:b.showSearchHint;if(0<b.columns.filter(function(a){return"_ROW_ID"===a.columnId}).length)console.error("_ROW_ID is specifically defined column for Folium Table. Please try to name this column with a different name.");
else{b.rows.forEach(function(a){Object.defineProperty(a,"_ROW_ID",{value:C,writable:!1,enumerable:!0,configurable:!1});C++});y.set("number",L);y.set("float",L);y.set("integer",L);y.set("datetime",function(a,b){return a>b?1:a<b?-1:0});y.set("string",Q);y.set(void 0,Q);z.set("integer",function(a){return parseInt(a)});z.set("float",function(a){return parseFloat(a)});z.set("number",function(a){return parseFloat(a)});z.set("datetime",function(a){return new Date(a)});z.set("integer",function(a){return a.toString()});
z.set(void 0,function(a){return a.toString()});E.addClass("folium");E.attr("tabindex","0");r=void 0!==b.rowsAsArrays&&null!==b.rowsAsArrays&&"boolean"===typeof b.rowsAsArrays?b.rowsAsArrays:!1;B=void 0!==b.cellRenderer?b.cellRenderer:function(a,b,d,e){return d};S=void 0!==b.headerRenderer?b.headerRenderer:function(a,b,d){return b};void 0!==b.width&&$(".folium").css("width",""+b.width);void 0!==b.height&&$(".folium").css("height",""+b.height);var T=b.columns;T.forEach(function(a){return N.set(a.columnId,
-1)});(function(a){var b='<thead><tr id="columns">';a.forEach(function(a,c){return b+='<th class="columnHeader sortHeader" id="'+a.columnId+'">'+S(c,a.displayText,a)+"</th>"});b+="</tr>";E.append(b+"</thead>")})(T);b.pagination.active&&"number"===typeof b.pagination.size&&($("#"+e).before('<div class="foliumPageBar"><button id="'+e+'foliumPageFirst" class="pageBarButton">First</button><button class="pageBarButton" id="'+e+'foliumPagePrevious"><</button><div id="'+e+'pageInfo" class="infoBox"><span id="currentPageInfo"></span><div id="foliumPageSwitcher"><select id="foliumPageJumpTo" class="pageJumpComboBox"><option value="1">1</option></select> / 0</div></div><button class="pageBarButton" id="'+
e+'foliumPageNext">></button><button class="pageBarButton" id="'+e+'foliumPageLast">Last</button><span id="searchInfo" class="pageBarText"></span></div>'),$(".foliumPageBar").css("width",$("#"+e).css("width")),d.pageSize=b.pagination.size,O(),$("#"+e+"foliumPageNext").click(function(){d.currentPage+1>d.numOfPages||(d.currentPage++,n(m?f:b.rows))}),$("#"+e+"foliumPagePrevious").click(function(){1>d.currentPage-1||(d.currentPage--,n(m?f:b.rows))}),$("#"+e+"foliumPageFirst").click(function(){1!==d.currentPage&&
(d.currentPage=1,n(m?f:b.rows))}),$("#"+e+"foliumPageLast").click(function(){d.currentPage!==d.numOfPages&&(d.currentPage=d.numOfPages,n(m?f:b.rows))}));void 0===b.pagination.size&&console.error("Pagination size is not defined! Pagination skipped.");A();$("td,th").on("focus",function(){$(U).closest("table").focus()});$("#"+b.tableId).focus(function(){$(document).attr("activeTable",b.tableId)});$("#"+b.tableId).focusout(function(){$(document).attr("activeTable",null)});$("#"+e+" thead th").click(function(){var a=
$(this).index();D=a;x(a);b.sortable&&(M(a),$("#"+b.tableId+" tbody").remove(),A(m?f:b.rows))});$(document).keydown(function(a){var c=$(document).attr("activeTable");a=a.keyCode;null!==c&&void 0!==c&&c===e&&(37===a?0>=l||x(l-1):38===a?0>=p||(H(p-1),x(l)):39===a?l!==K-1&&x(l+1):40===a?(c=$("#"+e+" tbody tr").length,p!==(b.pagination.active?c-1:h-1)&&(H(p+1),x(l))):b.editable&&R(v))});this.addRow=function(a){Object.defineProperty(a,"_ROW_ID",{value:C,writable:!1,enumerable:!0,configurable:!1});C++;b.rows.push(a);
h+=1;if(""!==t)this.search(t,G);else if(-1!==D&&M(D,!1),b.pagination.active)n();else{var c='<tr class="'+(0===(h-1)%2?"evenRow":"oddRow")+'">';b.columns.forEach(function(b,d){var e=r?a[d]:a[b.columnId],k=B(h-1,d,e,a);c+=void 0===e?"<td></td>":"<td>"+k+"</td>"});c+="</tr>";$("#"+e+" tbody").append(c)}};this.addRows=function(a){a.forEach(function(a,b){Object.defineProperty(a,"_ROW_ID",{value:C,writable:!1,enumerable:!0,configurable:!1});C++});b.rows=b.rows.concat(a);if(""!==t)this.search(t,G);else if(-1!==
D&&M(D,!1),b.pagination.active)n();else{var c="";a.forEach(function(a){var d='<tr class="'+(0===(h-1)%2?"evenRow":"oddRow")+'">';b.columns.forEach(function(b,c){var e=r?a[c]:a[b.columnId],k=B(h-1,c,e,a);d+=void 0===e?"<td></td>":"<td>"+k+"</td>"});d+="</tr>";c+=d;h++});$("#"+e+" tbody").append(c)}};this.updateRow=function(a,c){r?b.rows[a]=c:Object.keys(c).forEach(function(d){return b.rows[a][d]=c[d]});var d=b.rows[a],g="";b.columns.forEach(function(a,b){var c=r?d[b]:d[a.columnId],e=B(h-1,b,c,d);g+=
void 0===c?"<td></td>":"<td>"+e+"</td>"});var f=I.indexOf(d._ROW_ID);-1!==f&&$("#"+e+" tbody tr:eq("+f+")").html(g)};this.updateRows=function(a,b){var c=this;a.forEach(function(a){return c.updateRow(a,b[a])})};this.deleteRow=function(a){var c=b.rows.splice(a,1)[0];if(void 0!==c)if(--h,m)this.search(t,G);else if(b.pagination.active)n();else if(c=I.indexOf(c._ROW_ID),-1!==c)for(H(0!==c?c-1:0),$("#"+e+" tbody tr:eq("+c+")").remove();a<h;a++)c=0===a%2?"evenRow":"oddRow",$("#"+e+" tbody tr:eq("+a+")").removeClass().addClass(c)};
this.deleteRows=function(a){var c=a.filter(function(a){return a<h});b.rows=b.rows.filter(function(a,b){return-1===c.indexOf(b)});h-=c.length;m?this.search(t,G):b.pagination.active?n():($("#"+b.tableId+" tbody").remove(),A())};this.selectedRow=function(){return p};this.selectedRowInModel=function(){return J(p)};this.selectedColumn=function(){return l};this.columnCount=function(){return K};this.rowCount=function(){return h};this.getRow=function(a){return b.rows[a]};this.getRows=function(){return b.rows};
this.on=function(a,b){F.set(a,b)};this.currentPage=function(){return currentPage};this.pageCount=function(){return pageCount};this.getId=function(){return e};this.setLocale=function(a){q=a};this.search=function(a,c){c=void 0===c?-1:c;if(void 0===a||null===a||""===a)return f=void 0,t="",m=!1,$("#searchInfo").html(""),b.pagination.active?(d.currentPage=1,n()):A(),b.rows.length;t=a;f=r?-1!==c?b.rows.filter(function(b){return b[c].toLowerCase(q).includes(a.toLowerCase(q))}):b.rows.filter(function(b){return Object.values(b).join("`").toLowerCase(q).includes(a.toLowerCase(q))}):
-1!==c?b.rows.filter(function(d){return d[b.columns[c].columnId].toLowerCase(q).includes(a.toLowerCase(q))}):b.rows.filter(function(b){return Object.values(b).join("`").toLowerCase(q).includes(a.toLowerCase(q))});$("#"+b.tableId+" tbody").remove();b.pagination.active?(d.currentPage=1,n(f)):A(f);m=!0;b.pagination.active&&b.showSearchHint&&$("#searchInfo").html('Search Results for "'+t+'" presented'+(-1!==c?" according to <b>"+b.columns[c].displayText+"</b> column.":"."));return f.length};this.clear=
function(){$("#"+e+" tbody").empty();b.rows=[];h=0;l=p=-1;v=u=void 0;D=G=-1;d.currentPage=1;d.numOfPages=0;b.pagination.active&&O(b.rows)}}}};$.fn.FoliumTable=function(b){if(void 0===b)return this[0].foliumObject;b.tableId=this[0].id;b=new FoliumTable(b,$(this));this[0].foliumObject=b;return this[0].foliumObject};